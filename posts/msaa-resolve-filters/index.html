<!DOCTYPE html>
<html lang="en-us">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta itemprop="name" content="Experimenting with Reconstruction Filters for MSAA Resolve">
<meta itemprop="description" content="Previous article in the series: A Quick Overview of MSAA
Update 8/26/2017: while working on The Order I improved upon the work described here, which I presented at SIGGRAPH 2015. I also created an updated MSAA &#43; TAA filtering demo that you can find on GitHub, which just about completely supersedes the demo that&rsquo;s linked at the end of the article. So make sure that you look at the new one as well!">
<meta itemprop="datePublished" content="2012-10-29T07:33:31&#43;00:00" />
<meta itemprop="dateModified" content="2012-10-29T07:33:31&#43;00:00" />
<meta itemprop="wordCount" content="3825">



<meta itemprop="keywords" content="DirectX 11,Graphics,Programming," /><meta property="og:title" content="Experimenting with Reconstruction Filters for MSAA Resolve" />
<meta property="og:description" content="Previous article in the series: A Quick Overview of MSAA
Update 8/26/2017: while working on The Order I improved upon the work described here, which I presented at SIGGRAPH 2015. I also created an updated MSAA &#43; TAA filtering demo that you can find on GitHub, which just about completely supersedes the demo that&rsquo;s linked at the end of the article. So make sure that you look at the new one as well!" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://therealmjp.github.io/posts/msaa-resolve-filters/" />
<meta property="article:published_time" content="2012-10-29T07:33:31+00:00" />
<meta property="article:modified_time" content="2012-10-29T07:33:31+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Experimenting with Reconstruction Filters for MSAA Resolve"/>
<meta name="twitter:description" content="Previous article in the series: A Quick Overview of MSAA
Update 8/26/2017: while working on The Order I improved upon the work described here, which I presented at SIGGRAPH 2015. I also created an updated MSAA &#43; TAA filtering demo that you can find on GitHub, which just about completely supersedes the demo that&rsquo;s linked at the end of the article. So make sure that you look at the new one as well!"/>

	<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
	<link rel="manifest" href="/site.webmanifest">
	<link rel="mask-icon" href="/safari-pinned-tab.svg" color="">
	<link rel="shortcut icon" href="/favicon.ico">

	<title>Experimenting with Reconstruction Filters for MSAA Resolve</title>
	<link rel="stylesheet" href="https://therealmjp.github.io/css/style.min.9ae64a8094d0d100100f0725503238784f798a59c57003700be4d8b0645124e9.css" integrity="sha256-muZKgJTQ0QAQDwclUDI4eE95ilnFcANwC+TYsGRRJOk=">
</head>

<body id="page">
	
	<header id="site-header" class="animated slideInUp faster">
		<div class="hdr-wrapper section-inner">
			<div class="hdr-left">
				<div class="site-branding">
					<a href="https://therealmjp.github.io/">The Danger Zone</a>
				</div>
				<nav class="site-nav hide-in-mobile">
					
				<a href="https://therealmjp.github.io/posts/">Posts</a>
				<a href="https://therealmjp.github.io/about/">About</a>
				<a href="https://therealmjp.github.io/publications/">Publications</a>

				</nav>
			</div>
			<div class="hdr-right hdr-icons">
				<span class="hdr-social hide-in-mobile"><a href="https://github.com/TheRealMJP" target="_blank" rel="noopener me" title="Github"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg></a><a href="https://twitter.com/mynameismjp" target="_blank" rel="noopener me" title="Twitter"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg></a><a href="mailto:mpettineo@gmail.com" target="_blank" rel="noopener me" title="Email"><svg xmlns="http://www.w3.org/2000/svg" class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg></a></span><button id="menu-btn" class="hdr-btn" title="Menu"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></button>
			</div>
		</div>
	</header>
	<div id="mobile-menu" class="animated fast">
		<ul>
			<li><a href="https://therealmjp.github.io/posts/">Posts</a></li>
			<li><a href="https://therealmjp.github.io/about/">About</a></li>
			<li><a href="https://therealmjp.github.io/publications/">Publications</a></li>
		</ul>
	</div>


	<main class="site-main section-inner animated fadeIn faster">
		<article class="thin">
			<header class="post-header">
				<div class="post-meta"><span>Oct 29, 2012</span></div>
				<h1>Experimenting with Reconstruction Filters for MSAA Resolve</h1>
			</header>
			<div class="content">
				<p><em>Previous article in the series: <a href="../msaa-overview/">A Quick Overview of MSAA</a></em></p>
<p>Update 8/26/2017: while working on The Order I improved upon the work described here, which I <a href="http://advances.realtimerendering.com/s2015/rad_siggraph_advances_2015.pptx">presented</a> at SIGGRAPH 2015. I also created an updated <a href="https://github.com/TheRealMJP/MSAAFilter">MSAA + TAA filtering demo</a> that you can find on GitHub, which just about completely supersedes the demo that&rsquo;s linked at the end of the article. So make sure that you look at the new one as well!</p>
<p>Despite having the flexibility to implement a custom resolve for MSAA, the &ldquo;standard&rdquo; box filter resolve is still commonly used in games. While the box filter works well enough, it has some characteristics that can be considered undesirable for a reconstruction filter. In particular, the box function has a discontinuity at its edge that results in an infinite frequency response (the frequency domain equivalent of a box function is the sinc function). This causes it to introduce postaliasing when used as a reconstruction filter, since the filter is unable to isolate the original copy of a signal’s spectrum. The primary advantage offered by such a resolve is that it’s cheap from a performance point of view, since only subsamples within a single pixel need to be considered when computing a resolved pixel value.</p>
<p>The question we now want to answer is “can we do better?” Offline renderers such as Pixar&rsquo;s PRMan support a variety of  filter types for antialiasing, so it stands to reason that we should at least explore the possibilities for real-time graphics. If we decide to forego the “standard” resolve offered by <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ff476474%28v=vs.85%29.aspx">ResolveSubresource</a> and instead perform our own resolve using a pixel or compute shader that that accesses the raw multisampled texture data, we are pretty much free to implement whatever reconstruction filter we’d like. So there is certainly no concern over lack of flexibility. Performance, however, is still an issue. Every GPU that I’ve run my code on will perform worse with a custom resolve, even when using a simple box filter with results that exactly match a standard resolve. Currently the performance delta seems to be worse on AMD hardware as opposed to Nvidia hardware. On top of that, there’s additional costs for the increased texture samples required for wider filter kernels. Separable filtering can be used to reduce the number of samples required for wide filters, however you must have special considerations with the rotated grid sample patterns used by MSAA. Unfortunately I haven’t solved these problems yet, so for this sample I’m just going to focus on quality without too much regard for performance. Hopefully in a future article I can revisit this, and address the performance issues.</p>
<p>At this point I feel that I should bring up TXAA. If you’re not familiar, <a href="http://www.geforce.com/landing-page/txaa">TXAA</a> is a library-supported antialiasing technique introduced for recent Nvidia Kepler-based GPU’s. There’s no public documentation as to exactly how it works, but <a href="http://timothylottes.blogspot.com/">Timothy Lottes</a> has mentioned a <a href="http://timothylottes.blogspot.com/2012/07/txaa-out-30479-driver.html">few details</a> here and there on his blog. From the info he’s given, it seems safe to assume that the MSAA resolve used by TXAA is something other than a box filter, and is using a filter width wider than a pixel. Based on these assumptions, you should be able to produce similar results with the framework that I’ve set up.</p>
<h2 id="implementation">Implementation<a href="#implementation" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>The sample application renders my trusty tank scene in HDR to an fp16 render target with either 1x, 2x, 4x, or 8x MSAA enabled. Once the scene is rendered, a pixel shader is used to resolve the MSAA render target to a non-MSAA render target with one of ten available reconstruction filters. I implemented the following filters:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Box</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_01_box.png"><img src="/images/converted/msaa-resolve-filters/filter_01_box_resized_300.png" alt="" title="Filter_01_Box"></a></td>
</tr>
<tr>
<td>Triangle</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_02_triangle.png"><img src="/images/converted/msaa-resolve-filters/filter_02_triangle_resized_300.png" alt="" title="Filter_02_Triangle"></a></td>
</tr>
<tr>
<td>Gaussian</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_03_gaussian.png"><img src="/images/converted/msaa-resolve-filters/filter_03_gaussian_resized_300.png" alt="" title="Filter_03_Gaussian"></a></td>
</tr>
<tr>
<td>Blackman-Harris</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_04_blackmanharris.png"><img src="/images/converted/msaa-resolve-filters/filter_04_blackmanharris_resized_300.png" alt="" title="Filter_04_BlackmanHarris"></a></td>
</tr>
<tr>
<td>Smoothstep (Hermite spline)</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_05_smoothstep.png"><img src="/images/converted/msaa-resolve-filters/filter_05_smoothstep_resized_300.png" alt="" title="Filter_05_Smoothstep"></a></td>
</tr>
<tr>
<td>B-spline</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_06_bspline.png"><img src="/images/converted/msaa-resolve-filters/filter_06_bspline_resized_300.png" alt="" title="Filter_06_BSpline"></a></td>
</tr>
<tr>
<td>Catmull-Rom</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_07_catmullrom.png"><img src="/images/converted/msaa-resolve-filters/filter_07_catmullrom_resized_300.png" alt="" title="Filter_07_CatmullRom"></a></td>
</tr>
<tr>
<td>Mitchell</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_08_mitchell.png"><img src="/images/converted/msaa-resolve-filters/filter_08_mitchell_resized_300.png" alt="" title="Filter_08_Mitchell"></a></td>
</tr>
<tr>
<td>Generalized Cubic</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_09_cubic.png"><img src="/images/converted/msaa-resolve-filters/filter_09_cubic_resized_300.png" alt="" title="Filter_09_Cubic"></a></td>
</tr>
<tr>
<td>Sinc</td>
<td><a href="/images/converted/msaa-resolve-filters/filter_10_sinc.png"><img src="/images/converted/msaa-resolve-filters/filter_10_sinc_resized_300.png" alt="" title="Filter_10_Sinc"></a></td>
</tr>
</tbody>
</table>
<p>I started out by implementing some of the <a href="http://www.renderman.org/RMR/st/PRMan_Filtering/Filtering_In_PRMan.html">filters supported by PRMan</a>, and using similar parameters for controlling the filtering. However I ended up deviating from the PRMan setup in order to make things more intuitive (in my opinion, at least). All filters except for the sinc filter were implemented such that their &ldquo;natural range&rdquo; of non-zero values were in the [-0.5, 0.5] range. This deviates from the canonical filter widths for several of these filters, notably the cubic filters (which are normally defined for the [-2, 2] range). I then used a &ldquo;filter width&rdquo; parameter to inversely scale the inputs to the filtering functions. So for a filter width of 1.0, the filters all have a width equal to the size of a single resolved pixel. The one exception is the sinc filter, where I used the filter width to window the function rather than scaling the input value. I should also note that I implemented all of the filters as radial filters where the input is the screen-space distance from the output pixel center to the sample position. Typically filters for image scaling are used in separable passes where 1D filters are passed the X or Y sample distance. Because of this my &ldquo;Box&rdquo; filter is actually disc-shaped, but it produces very similar results. In fact for a filter width of 1.0 the results are identical to a &ldquo;standard&rdquo; box filter resolve. The &ldquo;Triangle&rdquo; filter uses a standard triangle function,which can be considered a &ldquo;cone&rdquo; function when used as a radial filter. &ldquo;Gaussian&rdquo; uses a standard Gaussian function with a configurable sigma parameter, with the result windowed to [-0.5, 0.5].  The &ldquo;Smoothstep&rdquo; filter simply uses the smoothstep intrinsic available in HLSL, which implements a cubic hermite spline. The &ldquo;Generalized Cubic&rdquo; filter is an implementation of the cubic function suggested by Mitchell and Netravali in their paper, with the B and C parameters being tweakable by the user. The &ldquo;B-spline&rdquo;, &ldquo;Mitchell&rdquo; and &ldquo;Catmull-Rom&rdquo; filters use this same function except with fixed values for B and C. &ldquo;Sinc&rdquo; is the standard sinc function, windowed to [-FilterWidth, FilterWidth] as mentioned previously.</p>
<p>To visualize the filtering function, I added a real-time 1D plot of the currently-selected filter function using the current filter width. I also added a plot of the 1D fourier transform of the filter function (calculated with the help if the awesomely easy-to-integrate <a href="http://sourceforge.net/projects/kissfft/">Kiss FFT library</a>), so that you can also visualize the frequency response of the selected filter type. This can be useful for estimating the amount of postaliasing produced by a filter, as well as the attenuation of frequencies below the Nyquist rate (which results in blurring).</p>
<p>After the resolve is performed, the result is fed into a standard post-processing chain. This phase includes average luminance calculation for auto-exposure, bloom, and HDR tone mapping. I added an option to tone map subsamples in a manner similar to <a href="http://www.humus.name/index.php?page=3D&amp;ID=77">Humus&rsquo;s sample</a>, so that the results can be compared to resolve prior to tone mapping. When this option is activated, the bloom and auto-exposure passes work with non-resolved MSAA textures since the output of the resolve no longer contains linear HDR values. Note that the resolve is still performed prior to post-processing, since I wanted to keep the resolve separate from the post-processing phase so that it was more visible. In production it would most likely be done after all post-processing, however you would still need the same considerations regarding working with non-resolved MSAA data.</p>
<p>Here&rsquo;s a full list of all options that I implemented:</p>
<ul>
<li><strong>MSAA Mode -</strong> the number of MSAA samples to use for the primary render target (1x, 2x, 4x, or 8x)</li>
<li><strong>Filter Type</strong> - the filtering function to use in the resolve step (supports all of the filters listed above)</li>
<li><strong>Use Standard Resolve</strong> - when enabled, a &ldquo;standard&rdquo; box filter resolve is performed using ResolveSubresource</li>
<li><strong>Tone Map Subsamples</strong> - when enabled, tone mapping is applied before the subsamples are resolved</li>
<li><strong>Enable FXAA</strong>  - enables or disables FXAA with high-quality PC settings</li>
<li><strong>Render Triangle</strong> - renders a plain red triangle in the center of the screen</li>
<li><strong>Bloom Exposure</strong> - an exposure (in log2 space) applied to HDR values in order to create the bloom source values</li>
<li><strong>Bloom Magnitude</strong> - a multiplier for the bloom value that&rsquo;s combined with the tone mapped result</li>
<li><strong>Auto-Exposure Key Value</strong> - key value for controlling auto-exposure</li>
<li><strong>Adaptation Rate</strong> - rate at which exposure is adapted over time</li>
<li><strong>Roughness</strong> - roughness used for material specular calculations</li>
<li><strong>Filter</strong> <strong>Size</strong> - the radius of the filter kernel (in pixels) used during the resolve step</li>
<li><strong>Gaussian Sigma</strong> - the sigma parameter for the Gaussian function, used by the Gaussian filter mode</li>
<li><strong>Cubic B</strong> - the &ldquo;B&rdquo; parameter to Mitchell&rsquo;s generalized cubic function, used by the Generalized Cubic filter mode</li>
<li><strong>Cubic C</strong> - the &ldquo;C&rdquo; parameter to Mitchell&rsquo;s generalized cubic function, used by the Generalized Cubic filter mode</li>
<li><strong>Magnification</strong> - magnification level for the final output (magnification is performed with point filtering)</li>
<li><strong>Triangle Rotation Speed</strong> - the speed at which the red triangle (enabled by Render Triangle) is rotated</li>
</ul>
<h2 id="results">Results<a href="#results" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>The following table contains links to 1280x720 screenshots from my sample application using various filter types and filter widths. All screenshots have use 4xMSAA, and perform the resolve in linear HDR space (bloom and tone mapping are performed after):</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Box</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_0_box_6.png">6.0</a></td>
</tr>
<tr>
<td>Triangle</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_1_triangle_6.png">6.0</a></td>
</tr>
<tr>
<td>Gaussian</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_2_gaussian_6.png">6.0</a></td>
</tr>
<tr>
<td>Blackman-Harris</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_3_blackman-harris_6.png">6.0</a></td>
</tr>
<tr>
<td>Smoothstep</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_4_smoothstep_6.png">6.0</a></td>
</tr>
<tr>
<td>B-spline</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_5_b-spline_6.png">6.0</a></td>
</tr>
<tr>
<td>Catmull-Rom</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_6_catmull-rom_6.png">6.0</a></td>
</tr>
<tr>
<td>Mitchell</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_7_mitchell_6.png">6.0</a></td>
</tr>
<tr>
<td>Sinc</td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/normal_9_sinc_6.png">6.0</a></td>
</tr>
</tbody>
</table>
<p>This table contains similar screenshots, except that the tone mapping is performed prior to the resolve:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Box</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_0_box_6.png">6.0</a></td>
</tr>
<tr>
<td>Triangle</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_1_triangle_6.png">6.0</a></td>
</tr>
<tr>
<td>Gaussian</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_2_gaussian_6.png">6.0</a></td>
</tr>
<tr>
<td>Blackman-Harris</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_3_blackman-harris_6.png">6.0</a></td>
</tr>
<tr>
<td>Smoothstep</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_4_smoothstep_6.png">6.0</a></td>
</tr>
<tr>
<td>B-spline</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_5_b-spline_6.png">6.0</a></td>
</tr>
<tr>
<td>Catmull-Rom</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_6_catmull-rom_6.png">6.0</a></td>
</tr>
<tr>
<td>Mitchell</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_7_mitchell_6.png">6.0</a></td>
</tr>
<tr>
<td>Sinc</td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_1.png">1.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_2.png">2.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_3.png">3.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_4.png">4.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_5.png">5.0</a></td>
<td><a href="/images/converted/msaa-resolve-filters/tonemap_9_sinc_6.png">6.0</a></td>
</tr>
</tbody>
</table>
<p>As we take a close look at the images, the results shouldn&rsquo;t be too surprising. For the most part, wider filter kernels tend to reduce aliasing while smaller filters preserve more high-frequency detail. Personally I find  that the cubic spline filters with no negative lobes (smoothstep and B-Spline) will produce the best results, with the best balance between aliasing and blurring occurring around the 2.0-3.0 range. Here is a magnified image showing the results of 4xMSAA with a standard 1-pixel-wide box filter, followed by the same image with a 3-pixel-wide B-spline filter:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic0_normal.png"><img src="/images/converted/msaa-resolve-filters/pic0_normal.png" alt="" title="Pic0_Normal"></a></p>
<p><a href="/images/converted/msaa-resolve-filters/pic0_bspline.png"><img src="/images/converted/msaa-resolve-filters/pic0_bspline.png" alt="" title="Pic0_BSpline"></a></p>
<center><i>4xMSAA with a "standard" 1-pixel-wide box filter, followed by 4xMSAA with a 3-pixel-wide B-spline filter</i></center>
<p>The appearance of aliasing is reduced on geometry edges with the B-spline filter, particularly edges with higher contrast. Here&rsquo;s another pair of images that are magnified even further, so that you can see the edge quality:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic1_normal.png"><img src="/images/converted/msaa-resolve-filters/pic1_normal.png" alt="" title="Pic1_Normal"></a></p>
<p><a href="/images/converted/msaa-resolve-filters/pic1_bspline1.png"><img src="/images/converted/msaa-resolve-filters/pic1_bspline1.png" alt="" title="Pic1_BSpline"></a></p>
<center><i>Highly magnified images showing 4xMSAA with a 1-pixel-wide box filter, followed by a 3-pixel-wide B-spline filter</i></center>
<p>Here&rsquo;s another set of images showing the results of a wider filter kernel on high-frequency details from normal maps and specular lighting:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic2_normal.png"><img src="/images/converted/msaa-resolve-filters/pic2_normal.png" alt="" title="Pic2_Normal"></a><a href="/images/converted/msaa-resolve-filters/pic2_bspline2.png"><img src="/images/converted/msaa-resolve-filters/pic2_bspline2.png" alt="" title="Pic2_BSpline2"></a><a href="/images/converted/msaa-resolve-filters/pic2_bspline3.png"><img src="/images/converted/msaa-resolve-filters/pic2_bspline3.png" alt="" title="Pic2_BSpline3"></a></p>
<center><i>4xMSAA with a 1-pixel-wide box filter, with a 2-pixel-wide B-spline filter, and with a 3-pixel-wide B-spline filter</i></center>
<p>As you can see in the images, a 2-pixel-wide B-spline filter is actually pretty good in terms of not attenuating details that are close to a pixel in size. A wider filter reduces aliasing even further, but I feel that  filter width of 2.0 is still an improvement over the quality offered by a &ldquo;standard&rdquo; resolve. So it&rsquo;s probably a pretty good place to start if you want better quality, but you prefer a sharper output image. The other cubic filters with negative lobes (such as Catmull-Rom and Mitchell) will also produce a sharper result, however the negative lobe can produce undesirable artifacts if they&rsquo;re too strong. This is especially true when filtering HDR values with high intensity, since they can have a strong effect on neighboring pixels. For this reason I think that Mitchell is a better option over Catmull-Rom, since Mitchell&rsquo;s negative lobes are bit less pronounced. The sinc filter is almost totally unappealing for an MSAA resolve, since the ringing artifacts that it produces are very prominent. Here are three images comparing a 4-pixel-wide Catmull-Rom filter, a 4-pixel-wide Mitchell filter, and a 6-pixel-wide sinc filter:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic5_catmullrom.png"><img src="/images/converted/msaa-resolve-filters/pic5_catmullrom.png" alt="" title="Pic5_CatmullRom"></a></p>
<p><a href="/images/converted/msaa-resolve-filters/pic5_mitchell.png"><img src="/images/converted/msaa-resolve-filters/pic5_mitchell.png" alt="" title="Pic5_Mitchell"></a></p>
<p><a href="/images/converted/msaa-resolve-filters/pic5_sinc.png"><img src="/images/converted/msaa-resolve-filters/pic5_sinc.png" alt="" title="Pic5_Sinc"></a></p>
<p>All of the above images used 4xMSAA, but a wider filter kernel can also work well for 2xMSAA. Here&rsquo;s some close-ups showing &ldquo;normal&rdquo; 2xMSAA vs. 2xMSAA with a B-spline filter vs. 4xMSAA with a B-spline filter:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic4_2x_normal.png"><img src="/images/converted/msaa-resolve-filters/pic4_2x_normal.png" alt="" title="Pic4_2x_Normal"></a><a href="/images/converted/msaa-resolve-filters/pic4_2x_bspline.png"><img src="/images/converted/msaa-resolve-filters/pic4_2x_bspline.png" alt="" title="Pic4_2x_BSpline"></a><a href="/images/converted/msaa-resolve-filters/pic4_4x_bspline.png"><img src="/images/converted/msaa-resolve-filters/pic4_4x_bspline.png" alt="" title="Pic4_4x_BSpline"></a></p>
<center><i>2xMSAA with standard resolve, 2xMSAA with a 3-pixel-wide B-spline filter, and 4xMSAA with a 3-pixel-wide B-spline filter</i></center>
<p>To wrap things up, here a two close-ups showing the results of a wide B-spine filter applied before tone mapping, and the same image with tone mapping applied prior to filtering:</p>
<p><a href="/images/converted/msaa-resolve-filters/pic3_normal.png"><img src="/images/converted/msaa-resolve-filters/pic3_normal.png" alt="" title="Pic3_Normal"></a><a href="/images/converted/msaa-resolve-filters/pic3_tonemap.png"><img src="/images/converted/msaa-resolve-filters/pic3_tonemap.png" alt="" title="Pic3_ToneMap"></a></p>
<center><i>4xMSAA with a 3-pixel wide B-spline filter applied before tone mapping, and after tone mapping</i></center>
<p>These results are little interesting since they illustrate the differences in the two different approaches. In the first image the filtering is performed with HDR values, so you get similar effects to applying DOF or motion blur in HDR where bright values can dominate their local neighborhood. The second image shows quite a different result, where the darker geometry actually ends up looking &ldquo;thicker&rdquo; against the bright blue sky. In general I don&rsquo;t find that it produces a substantial improvement when you&rsquo;re already using a wider filter kernel, or at least not enough to justify the extra effort and performance required to make it work with an HDR post-processing pipeline. However it does tend to play nicer with cubic filters that have negative lobes, since you&rsquo;re not filtering HDR values with arbitrary intensity.</p>
<h2 id="conclusions">Conclusions<a href="#conclusions" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h2>
<p>There are clearly a lot of options available to you if you choose to implement a custom MSAA resolve. I think there&rsquo;s some good opportunities here to do an even better job at reducing aliasing in games, and personally I&rsquo;m of the opinion that it&rsquo;s worth reducing the appearance of tiny pixel-wide details if it results in an overall cleaner image. Either way I don&rsquo;t think that a box filter is the best choice no matter what your tastes are.</p>
<p>If you want to download the sample app with source code, you can grab it <a href="http://mynameismjp.files.wordpress.com/2012/10/msaafilter.zip">here</a>. Feel free to download it and perform your own experiments, although I&rsquo;d appreciate if you&rsquo;d share your results and opinions!</p>
<p>Some quick notes about the sample code: I decided to use the newer DirectX headers and libraries from the Windows 8 SDK, so you&rsquo;ll need to have it installed if you want to compile the project. I haven&rsquo;t fully migrated to VS 2012 yet, so I&rsquo;ve left the project in VS 2010 format so that it can be opened by either. I also overhauled a lot of my sample framework code, which includes a shader caching system that uses the totally-awesome <a href="https://sites.google.com/site/murmurhash/">MurmurHash</a> to detect when a shader needs to be re-compiled. Using the new SDK also entailed ditching D3DX, so I&rsquo;ve replaced the texture and mesh loading functionality that I was using with some of my own code combined with some code lifted from <a href="http://directxtk.codeplex.com">DirectXTK</a>. One major downside I should mention is that I&rsquo;m only supporting x64 for now, due to some annoyances with the SDK and redistributing D3DCompiler DLL&rsquo;s. If anybody is still stuck on 32-bit Windows and really wants to run the sample, let me know and I&rsquo;ll try to find some time to get it working.</p>
<hr>
<h3 id="comments">Comments:<a href="#comments" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h3>
<h4 id="heading"><a href="#heading" class="anchor" aria-hidden="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 0 1 5 5 5 5 0 0 1-5 5h-3m-6 0H6a5 5 0 0 1-5-5 5 5 0 0 1 5-5h3"></path><line x1="8" y1="12" x2="16" y2="12"></line></svg></a></h4>
<p><a href="%22macroblock16x16@gmail.com%22">Bryant</a> - <time datetime="2013-01-06 00:13:52">Jan 0, 2013</time></p>
<p>@MJP This is really interesting work, It&rsquo;s unfortunate that you can&rsquo;t use shaders to do custom sample arrangements; it would be great to have access to the samples in order to set your own sample count and arrangement (jittered, poisson, etc). You included sinc in the test, have you done any further tests with windowed sinc functions? It would be interesting to see the effects of reconstruction with a sinc function using different windowing functions, particularly as the breadth of the kernel increases. You&rsquo;ve said your kernels are symmetrical, I know the guys over at ImageMagick have added symmetrical kernels to their resampling with the -distort operator that makes use of elliptical weighted averaging. Have you had any discussions with them? Great articles as usual, it&rsquo;s great talking to you guys from Beyond3D.</p>
<hr />
####
[Timothy Lottes](http://timothylottes.blogspot.com/ "timothylottes@gmail.com") - <time datetime="2012-10-30 09:26:03">Oct 2, 2012</time>
<p>Here is another trick I am using in my title. When correctly doing a linear HDR resolve, linear HDR post processing, then tonemapping to LDR right before scan-out (long after the resolve), bloom plays an important roll in removing any aliasing left over by extreme high dynamic range samples. Usually the tail section of the resolve filter kernel (the smallest coef) help in removing HDR aliasing, when this fails, using bloom to distribute the energy can remove (or rather hide) the remaining aliasing. In order to make the bloom pass fast, one can do an extremely low-cost 1/2x1/2 resolution down-sample during the resolve shader. Note the resolve kernels are radially symmetric. Taking 20 samples in a circle at 4xMSAA, there are 5 sets of 4 samples where each set has the same kernel weight. Taking the sum of samples in each set results in 5 new &ldquo;ring&rdquo; samples. It is fast to both compute the filtered resolve output (weight sum of the 5 &ldquo;ring&rdquo; samples), and the average of the 16 samples in a 2x2 pixel box centered on the pixel (average of 4 &ldquo;ring&rdquo; samples). Then use the standard pixel shader output to store the filtered resolve. And in the same pixel shader, use surface stores (imageStore() in GL) to write out the 2x2 pixel average to the 1/2x1/2 resolution target. Predicate the store to the upper-left pixel of each 2x2 pixel quad. Afterwards the 1/2x1/2 resolution target has the box filtered down-sample (which still needs proper filtering, but at least is fully energy conserving), but just shifted towards the upper-left pixel. It is important to &ldquo;undo&rdquo; the shift when doing the first bloom filtering pass.</p>
<hr />
####
[Timothy Lottes](http://timothylottes.blogspot.com/ "timothylottes@gmail.com") - <time datetime="2012-10-30 08:34:28">Oct 2, 2012</time>
<p>Re &ldquo;randomized sampling&rdquo;, I have not tried this either. Something to keep in mind, in theory, fixed sampling locations can be optimized by the driver into constants avoiding address computation. Fixed sample locations also insure that the filter weight computation can be factored into constants. Also the energy of the kernel is mostly in the samples inside the pixel (say over 50%, for 4 samples for 4xMSAA), so one always wants to include those samples. The rest of the energy distributed over a much larger number of samples (say up to 32 samples if using a 3x3 pixel kernel). In the aim of reducing samples, it probably makes more sense to do a fixed truncation of samples towards the outside of the kernel as they contribute less energy. For my game (a personal independent project) I&rsquo;ve been using 4xMSAA with 16 or 20 samples (circle pattern instead of full 32 in the 3x3 pixel square) using kernel {B=1,C=0} (no negative lobes) and resolving in one pass.</p>
<hr />
####
[Osamar]( "osamar2001@hotmail.com") - <time datetime="2012-10-30 07:21:24">Oct 2, 2012</time>
<p>I have not the mathematical or programming knoledge. But, it could be faster to calculate a &ldquo;step pyramid&rdquo; like filter, or all cost more or less the same?</p>
<hr />
####
[AmazingFactory]( "first10@btinternet.com") - <time datetime="2012-10-30 05:47:33">Oct 2, 2012</time>
<p>Impressive work The &ldquo;Filtering in PRMan&rdquo; article has a great description of aliasing: Aliasing = high frequency data masquerading as low-frequency data (jaggies, Moiré, noise, sparkling, popping, etc.) that results from sampling a signal with improper filtering. And since the aliasing is mixed in with the real low-frequency data, once added it cannot be removed.</p>
<hr />
####
[mkh]( "") - <time datetime="2013-03-02 06:39:48">Mar 6, 2013</time>
<p>Nice article! I&rsquo;m interested in playing with the sample, however the download at Codeplex seems to be broken. Could you reupload the sample? Thanks alot! Cheers!</p>
<hr />
####
[Jeremy Shopf &raquo; Image Reconstruction and MSAA](http://jshopf.com/blog/?p=304 "") - <time datetime="2012-11-01 17:15:37">Nov 4, 2012</time>
<p>[&hellip;] posted a truly excellent read regarding resolving multi-sampled images titled “Experimenting with Reconstruction Filters for MSAA Resolve”. Even better, he had previously posted a nice sampling theory primer and introduction to MSAA which [&hellip;]</p>
<hr />
####
[MJP](http://mynameismjp.wordpress.com/ "mpettineo@gmail.com") - <time datetime="2013-03-02 12:49:56">Mar 6, 2013</time>
<p>The Codeplex link still seems to be working for me, but just in case I uploaded the zip file to my Google Drive as well: <a href="https://docs.google.com/file/d/0B9NkyJjiExTjR3Z0YzRIQUdYWkU/edit?usp=sharing">https://docs.google.com/file/d/0B9NkyJjiExTjR3Z0YzRIQUdYWkU/edit?usp=sharing</a></p>
<hr />
####
[anteru]( "wordpress@catchall.shelter13.net") - <time datetime="2012-10-29 00:09:51">Oct 1, 2012</time>
<p>Cool, I did something similar (but less extensive) two years ago: <a href="https://bitbucket.org/Anteru/wideaaresolve">https://bitbucket.org/Anteru/wideaaresolve</a> That was partially fallout from the SRAA research, which requires a wider resolve for good quality. Especially on the test scene I used, with lots of contrast, Lanczos resolve is so much better than the standard MSAA that it&rsquo;s not even funny any more. One thing I never got around to try is randomized sampling, by picking a subset of the samples for each pixel. This will introduce noise, but should make it faster as you need to fetch less samples per pixel.</p>
<hr />
####
[Timothy Lottes]( "tlottes@nvidia.com") - <time datetime="2012-10-29 08:56:14">Oct 1, 2012</time>
<p>Awesome write up. As for performance of custom resolves, I&rsquo;ve got a few performance related bugs filled on this at NVIDIA so If anyone is looking to ship a title using a wide resolve kernel, please send email note to nvidia.com, user tlottes, and I can use as leverage to get higher priority getting those (software) bugs fixed.</p>
<hr />
####
[deadc0de](http://c0de517e.blogspot.ca "kenpex@tin.it") - <time datetime="2012-10-29 20:00:23">Oct 1, 2012</time>
<p>You rock - Angelo</p>
<hr />
####
[MJP](http://mynameismjp.wordpress.com/ "mpettineo@gmail.com") - <time datetime="2012-10-29 20:39:44">Oct 1, 2012</time>
<p>@anteru: that&rsquo;s a really cool demo, I&rsquo;ve never seen it before! What you&rsquo;d *really* want to improve the sampling quality is to adjust the sampling positions used for rasterization per-pixel, but unfortunately with GPU&rsquo;s it seems that we&rsquo;re stuck with a fixed pattern. @Timothy: thank you! I&rsquo;ll be sending you an email shortly. @Angelo: thank you sir. :-)</p>
<hr />
####
[Image Reconstruction and MSAAJeremy Shopf](http://www.jshopf.net/?p=304 "") - <time datetime="2013-08-05 18:24:48">Aug 1, 2013</time>
<p>[…] posted a truly excellent read regarding resolving multi-sampled images titled “Experimenting with Reconstruction Filters for MSAA Resolve”. Even better, he had previously posted a nice sampling theory primer and introduction to MSAA which […]</p>
<hr />
####
[SIGGRAPH FOLLOW-UP: 2015 Edition | The Danger Zone](https://mynameismjp.wordpress.com/2015/08/16/siggraph-2015/ "") - <time datetime="2015-08-16 21:18:04">Aug 0, 2015</time>
<p>[…] play around with the shaders. The sample is essentially a successor to the MSAAFilter sample that I put out nearly 3 years ago, which accompanied a blog post where I shared some of my research on using higher-order filtering […]</p>
<hr />
####
[MJP](http://mynameismjp.wordpress.com/ "mpettineo@gmail.com") - <time datetime="2017-06-01 21:17:24">Jun 4, 2017</time>
<p>Hey there, that was a bug in the original implementation. I had fixed it at some point, but I guess that the version uploaded here is still the original with the bug. Anyhow, I would suggest looking at the newer MSAAFilter sample that I posted on GitHub, since that one improves on the old sample in just about every way: <a href="https://github.com/TheRealMJP/MSAAFilter">https://github.com/TheRealMJP/MSAAFilter</a></p>
<hr />
####
[Simpetar]( "simpetar@yandex.ru") - <time datetime="2017-06-01 07:54:09">Jun 4, 2017</time>
<p>Sorry, may be i missed something but i cannot understand the line 196 in your resolve.hlsl shader: SampleOffset += SampleOffsets[subSampleIdx].xy; Why is here += in the inner loop? As far as i understand it will be correct only for index 0. Thank you for your answer.</p>
<hr />

			</div>
			<hr class="post-end">
			<footer class="post-info">
				<p>
					<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://therealmjp.github.io/tags/directx-11">DirectX 11</a></span><span class="tag"><a href="https://therealmjp.github.io/tags/graphics">Graphics</a></span><span class="tag"><a href="https://therealmjp.github.io/tags/programming">Programming</a></span>
				</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>3825 Words</p>
				<p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2012-10-29 00:33 -0700</p>
			</footer>
		</article>
		<div class="post-nav thin">
			<a class="next-post" href="https://therealmjp.github.io/posts/hlsl-udl/">
				<span class="post-nav-label"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-left"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>&nbsp;Newer</span><br><span>HLSL User Defined Language for Notepad&#43;&#43;</span>
			</a>
			<a class="prev-post" href="https://therealmjp.github.io/posts/msaa-overview/">
				<span class="post-nav-label">Older&nbsp;<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-arrow-right"><line x1="5" y1="12" x2="19" y2="12"></line><polyline points="12 5 19 12 12 19"></polyline></svg></span><br><span>A Quick Overview of MSAA</span>
			</a>
		</div>
		<div id="comments" class="thin"><script src="https://utteranc.es/client.js"
        repo="TheRealMJP/TheRealMJP.github.io"
        issue-term="title"
        label="comments"
        theme="photon-dark"
        crossorigin="anonymous"
        async>
</script></div>
	</main>

	<footer id="site-footer" class="section-inner thin animated fadeIn faster">
		<p>&copy; 2020 <a href="https://therealmjp.github.io/">MJP</a></p>
		<p>
			Made with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> &#183; Theme <a href="https://github.com/Track3/hermit" target="_blank" rel="noopener">Hermit</a> &#183; <a href="https://therealmjp.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
		</p>
	</footer>


	<script src="https://therealmjp.github.io/js/main.min.d1b247cbe4b98a4f2db4cae020d2b180d0b585a34ed4d751cb0072d5676fc52a.js" integrity="sha256-0bJHy+S5ik8ttMrgINKxgNC1haNO1NdRywBy1WdvxSo="></script>



</body>

</html>
